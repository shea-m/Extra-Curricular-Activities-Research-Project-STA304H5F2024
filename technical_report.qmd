---
title: "Various Demographic Factors Effect on Students’ Participation In Extracurricular Activities"
subtitle: "Data Collected from STA304H5F in 2024"
author: 
  - Vanshika Vanshika
  - Navya Hooda
  - Shea Munson
  - Alexia Mbagaya
  - Chloe Syriac
  
thanks: "Code and data are available at: https://github.com/vanshikav2/Extra_Curricular_Activities_Research"
date: today
date-format: long
header-includes:
  - \usepackage{amsmath}
  - \usepackage{amssymb}
  - \usepackage{pgfplots}
abstract: "It is known that for students to have a well-rounded university experience, participation in extracurricular activities is vital, not only for academic but personal growth. However, student participation in extracurricular activities depends on a number of factors. Some include scheduling and time-commitment factors, commute factors and the diversity of student activities/clubs. This study aims to explore this by investigating the reasons that students select certain extracurricular activities at the University of Toronto Mississauga (UTM) campus. An anonymous online survey on Google Forms was created for students in a third-year Statistics course to complete. Findings showed that there was no significant relationship between campus distance and program of study with extracurricular involvement. Additionally, findings showed there was statistical significance between student status and activity preference (p=0.013). The findings also showed there was a statistically significant monotonic increasing relationship ($\\rho$ = 0.937) between time commitment and activity count. As students increase their time commitment, so does their participation in extracurricular activities (ECAs). Although results produced minimal significant findings, we believe that this is a valiant step in the right direction towards investigating student participation at UTM."
format: pdf
number-sections: true
toc: true
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(readxl)
library(here)
library(reshape2)
library(gridExtra)
data <- read.csv("STA304_TheOutliers_CleanedData.csv")

```

# Introduction

An important part of having a healthy life in university is maintaining a balance between school, work, and social life. Among other aspects, a major part of many university students’ social lives is extracurricular activities (ECAs). Being such a major part of students’ social lives, determining what factors can negatively impact student participation in ECAs is a critical step in helping minimize negative impacts on students’ wellbeing. In our study, we focused on students in STA304 students in Fall of 2024 and examined their levels of participation in various kinds of ECAs. In particular, we analyzed if various demographic factors affected students’ participation in ECAs. As UTM is primarily a commuter campus, of special interest was students living distance from campus. To conduct our study, during the first three weeks of October 2024 we distributed a survey on the STA304 Piazza Discussion board to collect data on student demographics factors and information relating to individual participation in ECAs. Our study consisted of three research questions.

## Research Questions and Hypotheses

1.  **Research Question 1**: What is the most preferred type of extracurricular activity, and do demographic factors influence student preferences for certain extracurricular activities?
    -   $H_{0}$: Student demographic factors have no effect on participation in extracurricular activities.
    -   $H_{a}$: Participation in extracurricular activities is affected by demographic factors.
2.  **Research Question 2**: Does proximity to campus affect participation in extracurricular activities?
    -   $H_{0}$: Proximity to campus has no effect on participation in extracurricular activities.
    -   $H_{a}$: Students living further from campus will have lower participation rates.
3.  **Research Question 3**: Does timing/scheduling of extracurricular activities impact student participation in extracurricular activities?
    -   $H_{0}$: Timing/scheduling of extracurricular activities has no impact on student participation.
    -   $H_{a}$: Participation in extracurricular activities is affected by their timing/scheduling.

# Data {#sec-data}

## Methodology

Data collection began in the first three weeks of October 2024, and an online anonymous survey on Google Forms was created for participants to complete. This survey was created in order to investigate the reasons that students select and participate in certain ECAs. This online survey was posted to a Piazza thread where students can easily locate the survey link. Although Stratified Random Sampling with lecture sections (LEC0101 and LEC0102) as the strata was proposed, the study was carried out using Simple Random Sampling. StRS was not used due to the homogeneity of the lecture sections which negates any tangible benefits that StRS would have provided over SRS. Nevertheless, randomness was ensured as the link to the survey was posted to Piazza where everyone had the equal opportunity to complete the survey and be chosen for the study. We collected a sample of 63 students. The survey consisted of 10 questions asking for details on their lecture section, demographic information, program of study, and distance from the UTM campus. We also included questions on the number, types, and the time commitment of the ECAs they are involved in. To encourage students to complete our online survey, we asked participants to share a link to their group's survey, which we would complete in return.

We computed our sample size from a population of $N = 200$, we chose a bound on the error of $B = 0.1047$ and calculated with an approximation of the sample proportion being $p = 0.5$. Calculating a sample size using $n = \frac{Npq}{(N-1)\frac{B^2}{4}+pq}$ gives $\frac{200*0.25*0.25}{(200-1)*\frac{0.1047^2}{4}+0.25} = 62.8643 \approx 63$

# Analysis {#sec-data1}

The analysis for our research questions is depending on student responses to the various demographic questions asked in the survey. While each of the research questions will provide in depth the results of the relevant demographic questions, it is still beneficial to provide a cursory overview of the demographic results to provide context for the study as a whole. Our survey received 64 responses, with one duplicate being discarded, to give a sample size of n = 63. Of that sample, results indicated higher percentage of males vs females, approximately a 6:4 ratio. Student status, distance from campus, and major breakdown are presented below visually, followed by brief summaries of the graphs.

```{r, fig.width=10, fig.height=3}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Correlation Analysis"
#| label: p3
library(tidyverse)
library(treemapify)
library(gridExtra)
library(patchwork)

majTab=table(gsub("\\s+", "", unlist(strsplit(data$major,",")))) # Split into Single Items
majDF=as.data.frame(majTab) # Convert to Data Frame
majDF$Var1=fct_relevel(majDF$Var1, c("STA", "MAT", "CSC", "ECO", "LSC", "NLA")) # Refactor for Correct Plot Order
majLabs=c("Applied Statistics", "Mathematics", "Computer Science", "Economics", "Life Sciences", "Not Listed")
statusCounts=as.data.frame(table(data$studentStatus))
statusLabs=c("Domestic", "International")
distanceDF=as.data.frame(table(data$campusDistance))
distanceLabs=c("On Campus", "0-5km", "6-10km", "11-15km", "16-20km", "21+km")

status <- ggplot(data=statusCounts, aes(area=Freq, fill=Var1, label=paste(Freq))) + 
  geom_treemap(color="black", size=1.0) +
  labs(title="Student Status", x="n = 63", caption = "Figure 1") + theme_minimal() +
  scale_fill_brewer(name="Options", labels=statusLabs, palette = "Set2") + 
  geom_treemap_text(colour="black", place="center") 
  

dist <- ggplot(data=distanceDF, aes(area=Freq, fill=Var1, label=paste(Freq))) + 
  geom_treemap(color="black", size=1.0) + 
  labs(title = "Distance From Campus", x="n = 63", caption = "Figure 2") +
  theme_minimal() +
  scale_fill_brewer(name="Distance", labels=distanceLabs, palette = "Set2") + 
  geom_treemap_text(color="black", place="center") + 
  theme(plot.title = element_text(hjust = 0.5))

maj <- ggplot(data=majDF, aes(x=Var1, y=Freq, fill=Var1)) + 
  geom_bar(stat="identity", color="Black") + 
  labs(x="Majors", y="Count", title = "Sample Majors Breakdown", caption = "Figure 3") + 
  theme_light() + 
  scale_fill_brewer(name="Options:", labels=majLabs, palette="Set2") + 
  geom_text(aes(label=Freq), vjust=-.3, color="black") + 
  theme(plot.title = element_text(hjust = 0.5),
        axis.title.y = element_text(size=12, angle=90), 
        axis.text.x = element_text(size= 6))

(status + dist +  maj) + plot_layout(widths = c(1,1,1))

```
Figure 1: The sample indicated an almost even split between International and Domestic Students

Figure 2: Students reported the distance they lived from campus in intervals of 5km

Figure 3: Students reported up to two majors, with the sample showing a large share of STA

## Research Question 1

In this question we aimed to explore and find out which is the most preferred types of extracurricular activities whilst also examining whether demographic factors such as major, demographics and student status influence the preference for certain extracurricular activities. By conducting this analysis we hope to gain an understanding of the sample and the wider population in their extracurricular selection habits.

**NOTE:** For easy analysis and ability to come up with clearer conclusions, the Major column and the activity column were split into different rows.

For the most preferred type of extracurricular activity, we were able to get the count of students in the different extracurricular activities and display a graph showing the counts of students in each extracurricular activity.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Count of Students by Activity Type"
#| label: rq1
library(tidyverse)
library(dplyr)
library(ggplot2)
library(car)
library(knitr)
library(kableExtra)
data <- read_csv("STA304_TheOutliers_CleanedData.csv")

#Deleting the studentID column and replacing NA values
data[is.na(data)] <- "NA"
data <- data %>% select(-studentID, -lectureSection)

#Split `activityType` and `major` into individual categories
data <- data %>%
  separate_rows(activityType, sep = ",") %>%
  separate_rows(major, sep = ",")

data <- data %>% mutate(activityType = trimws(data$activityType), major = trimws(data$major))


# Descriptive Analysis (What is the most preferred Extra Curricular Activity)
data <- data %>% mutate(activityType = as.factor(activityType))
activity_counts <- data %>%
  count(activityType, name = "Frequency") %>%
  arrange(desc(Frequency))

# Plot distribution of activity types
activity_labels <- c(
  "AAS" = "Athletics and Sports",
  "NEC" = "No Extracurricular Activities",
  "CLU" = "Clubs",
  "LSG" = "Leadership/Student Governments, Councils & Unions",
  "ACS" = "Academic Societies"
)

#Graph Showing the Activity Counts
ggplot(data = activity_counts, aes(x = activityType, y = Frequency, fill = activityType)) +
  geom_bar(stat = "identity", color = "black") +
  labs(
    x = "Activity Type",
    y = "Frequency",
    title = "Distribution of Extracurricular Activity Types"
  ) +
  theme_light() +
  scale_fill_brewer(
    name = "Activity Options:",
    labels = activity_labels,  
    palette = "Set2"  
  ) +
  geom_text(aes(label = Frequency), vjust = -0.3, size = 4)


```

According to the bar plot, the most popular extracurricular activity among students was Athletics and Sports (AAS) with 42 students and the least popular extracurricular activity is Academic Societies (ACS) with 9 students. It was also particularly interesting to observe that most students do not participate in Extracurricular Activities, making the NEC category second in popularity.

To investigate the proportion of students participating in each activity by demographic factors like Major, Student Status and Gender Identity, we used three statistical tests, namely ANOVA, Welch-t-Test and the Wilcoxon rank-sum Test.

Before we began with our tests we first conducted preliminary assumption tests.

### Testing for the Significance of Majors on Activity Preference using the ANOVA Test

To test for Normality we used a Q-Q residuals plot.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Q-Q Residuals Plot"
#| label: r2
# -----------------------------
# 2. ANOVA for Major
# -----------------------------
#Convert ActivityType to NumericValues
data <- data %>% mutate(activityTypeNumeric = as.numeric(factor(activityType)))

anova_major <- aov(activityTypeNumeric ~ major, data = data)
#summary(anova_major)

#Q-Q plot of Residuals
residuals <- residuals(anova_major)

qqnorm(residuals, col = "purple", main = "Q-Q Plot of Residuals for ANOVA Model
       for Major")

qqline(residuals, col = "black", lwd = 1)
```

From the plot we can observe that the residuals are not normally distributed as they do not follow the straight line.

To test the equality of variances within each group we used the Levene Test.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Levene Test"
#| label: r3
library(car)
library(knitr)
##Testing for Homogenity of Variances
data <- data %>%
  mutate(major = as.factor(major))
levene_test_major <- leveneTest(activityTypeNumeric ~ major, data = data)
levene_df <- as.data.frame(levene_test_major)

levene_df[is.na(levene_df)] <- ""

kable(levene_df, caption = "Levene Test on The Activity Preference by Major")
```

For the Levene test, we found that our F-statistc was 0.8882 and a p-value of 0.5433. Since the p-value is greater than the significance level of 0.05 we fail to reject the null hypothesis. This suggests that the variances in Activity Preferences across the groups are not significantly different. Therefore our assumption of homogeneity of variances is satisfied.
As much as the normality was violated we still opted to use the ANOVA test since it passed the Levene Test confirming the homogeneity of variances and the sample size is large enough.

We then conducted the ANOVA Test to determine whether there are any significant differences in the mean proportions of student activity preferences and their respective majors.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Anova Test of Activity Preference by Major"
#| label: r4
anova_summary <- summary(anova_major)[[1]]
anova_df <- data.frame(anova_summary)
anova_df[is.na(anova_df)] <- ""
kable(anova_df, caption = "Anova Test on The Activity Preference by Major")
```

After the ANOVA Analysis we can found the F-statistic was 0.8040 and a p-value of 0.5490. Since our p-value is greater than α = 0.05 we concluded that the differences in mean activity preferences across majors are not statistically significant.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Boxplot on Major and Activity Proportion"
#| label: r5

activity_lbls <- c(
  "1" = "ACS",  
  "2" = "AAS",
  "3" = "CLU",
  "4" = "LSG",  
  "5" = "NEC"   
)

```

### Testing for the Significance of Gender on Activity Preference using the T-Test

Before we began the analysis, we conducted preliminary tests to ensure that we are fit to use this test.


```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Shapiro-Wilk Test on Gender Groups"
#| label: r6
##GenderIdentity
gender_data_F <- data %>% filter(genderIdentity == "F") %>% pull(activityTypeNumeric)
gender_data_M <- data %>% filter(genderIdentity == "M") %>% pull(activityTypeNumeric)

data <- data %>%
  mutate(genderIdentity = as.factor(genderIdentity))
shapiro_F <- shapiro.test(gender_data_F)
shapiro_M <- shapiro.test(gender_data_M)

shapiro_M_df <- as.data.frame(t(c(shapiro_M$statistic, shapiro_M$p.value)))
colnames(shapiro_M_df) <- c("W statistic", "p-value")
shapiro_F_df <- as.data.frame(t(c(shapiro_F$statistic, shapiro_F$p.value)))
colnames(shapiro_F_df) <- c("W statistic", "p-value")


shapiro_results <- data.frame(
  Gender = c("Males", "Females"),
  `W Statistic` = c(shapiro_F_df$`W statistic`, shapiro_M_df$`W statistic`),
  `p-value` = c(shapiro_F_df$`p-value`, shapiro_M_df$`p-value`)
)

kable(shapiro_results, col.names = c("Gender", "W Statistic", "p-value"),
      caption = "Shapiro-Wilk Test Results for Activity Preferences by Gender Groups")


```

We conducted the Shapiro-Wilk Test to determine if the distribution in both groups is normal. We were able to determine that both groups were not normal as both their p-values are below the significance level of 0.05. Showing that the normality is not satisfied for both groups.

To test the second Assumption of equality of variances we used the Levene Test.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Levene Test on Equality of Variances across Student Status Groups"
#| label: r7

levene_gender <- leveneTest(activityTypeNumeric ~ genderIdentity, data = data)

levene_gender_df <- as.data.frame(levene_gender)
levene_gender_df[is.na(levene_gender_df)] <- ""

kable(levene_gender_df, caption = "Levene Test for Equality of Variances in Activity Preferences by Gender Identity")
```

With an F-statistic of 6.192 which is quite high indicating that there is a big difference between the two groups, we got a p-value of 0.0142 which is less than 0.05 suggesting that the variances in activity preferences between males and females are significantly different.

Since our variances aren't equal and the normality assumption has also been violated we will conduct our significance test using the Welch t-Test.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Welch t-Test on Activity Preference and GenderIdentity"
#| label: r8

t_test_gender <- t.test(activityTypeNumeric ~ genderIdentity, data = data, var.equal = FALSE)

t_test_result_df <- data.frame(T_Statistic = t_test_gender$statistic, DF = t_test_gender$parameter, p_value = t_test_gender$p.value, MEAN_FEMALE = t_test_gender$estimate[1], MEAN_MALE = t_test_gender$estimate[2])

kable(t_test_result_df, caption = "Welch t-test on the Activity Proportion by Gender")

```

With a T-statistic of 0.8614, degrees of freedom of 111.33 and a p-value of 0.3908, we failed to reject the null hypothesis since p-value is greater the significance level of 0.05. This therefore indicates that there is no significant difference in the mean activity preferences between females(mean = 3.125) and males(mean = 2.8684). 
Hence concluding that Gender doesn't influence peoples extracurricular choices.

### Testing for the Significance of Student Status on Activity Preference using the T-Test

We conducted preliminary tests before using the test and our results are as shown below.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: r11

##StudentStatus
status_data_D <- data %>% filter(studentStatus == "D") %>% pull(activityTypeNumeric)
status_data_I <- data %>% filter(studentStatus == "I") %>% pull(activityTypeNumeric)

shapiro_D <- shapiro.test(status_data_D)
shapiro_I <- shapiro.test(status_data_I)

shapiro_results <- data.frame(
  StudentStatus = c("D", "I"),
  W_Statistic = c(shapiro_D$statistic, shapiro_I$statistic),
  P_Value = c(shapiro_D$p.value, shapiro_I$p.value)
)
kable(shapiro_results, caption = "Shapiro Test on studentStatus")

```

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Levene Test for Activity Preference and Student Status"
#| label: r12

data <- data %>%
  mutate(studentStatus = as.factor(studentStatus))
levene_status <- leveneTest(activityTypeNumeric ~ studentStatus, data = data)

levene_status_df <- as.data.frame(levene_status)
levene_status_df[is.na(levene_status_df)] <- ""

kable(levene_status_df, caption = "Levene Test on studentStatus")
```

From our results of the Shapiro-Wilk test we can concluded that our results are not normal.This is because we can see that the p-value of domestic students(0e+00) and international students(1e-07) are both less than  α = 0.05 allowing us to reject the null hypothesis. 

For the Levene Test, an F-value of 0.0109 and a p-value of 0.9171 we were able to conclude that we should fail to reject the null hypothesis meaning that there is no difference in variances of activity preferences between the student status groups. 

Since it failed the normality test, we opted to use the Wilcox test.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Wilcox Test of Activity Preference and Student Status"
#| label: r13
#| 
wilcox_test <- wilcox.test(activityTypeNumeric ~ studentStatus, data = data)

wilcox_test_df <- data.frame(
  Statistic = wilcox_test$statistic,
  P_Value = wilcox_test$p.value)

kable(
  wilcox_test_df,
  col.names = c("W Statistic", "P-Value"),
  caption = "Wilcoxon Rank-Sum Test Results for Activity Preferences by Student Status"
)
```

From the Wilcox Test of comparing the activity preferences between domestic and international students, with a W-statistic of 1428.5 and a p value of 0.01303 which is below the significance level of 0.05. This shows that there is a significant difference in activity preferences between domestic and international students.

### Conclusion on Research Question 1
The box plots below will help in validating and visualizing the results that we got above.

For the first box plot, it is a representation of the activity preferences across the different majors. The overlap of the boxes heavily suggests that there is no significant difference in activity Preferences between majors 

In the middle box plot, we can see the overlapping of the box plots, they also have almost similar medians further showing that there is no significant difference in activity preference between the two genders.

On the last box plot, we can see that the medians between the two are different which validates the result that we got from the Wilcox result. Even though the box plots are overlapping, there is more spread of activity preferences for international students compared to domestic students.

```{r, fig.width=10, fig.height=6}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Boxplots of Student Status, Major and Gender on Activity Preference"
#| label: r14

# Boxplot for Major influence
plot1 <- ggplot(data, aes(x = major, y = activityTypeNumeric, fill = major)) +
  geom_boxplot() +
  labs(title = "Boxplot of Activity Preferences by Major",
       x = "Major",
       y = "Activity Type") +
  scale_y_continuous(
    breaks = 1:5,
    labels = activity_lbls
  )+
  theme_minimal() + 
  theme(axis.text.y = element_text(size = 10),
    axis.title.y = element_text(size = 12), 
    plot.margin = margin(10, 10, 10, 20)
  )

# Boxplot for Gender Influence
plot2 <- ggplot(data, aes(x = genderIdentity, y = activityTypeNumeric, fill = genderIdentity)) +
  geom_boxplot() +
  labs(title = "Boxplot of Activity Preferences by Gender",
       x = "Gender Identity",
       y = "Activity Type (Numeric)") +
  scale_y_continuous(
    breaks = 1:5,
    labels = activity_lbls)+
  theme_minimal() + 
  theme(axis.text.y = element_text(size = 10),
    axis.title.y = element_text(size = 12), 
    plot.margin = margin(10, 10, 10, 20)
  )
# Boxplot for StudentStatus
plot3 <- ggplot(data, aes(x = studentStatus, y = activityTypeNumeric, fill = studentStatus)) +
  geom_boxplot() +
  labs(title = "Boxplot of Activity Preferences by Student Status",
       x = "Student Status",
       y = "Activity Type (Numeric)") +
  scale_y_continuous(
    breaks = 1:5,
    labels = activity_lbls)+
  theme_minimal() +
  theme(axis.text.y = element_text(size = 10),
    axis.title.y = element_text(size = 12), 
    plot.margin = margin(10, 10, 10, 20)
  )


grid.arrange(plot1, plot2, plot3, nrow = 2)
```

## Research Question 2

In RQ2, we analysed if the proximity to campus affects one’s ability to participate in extracurricular activities.

-   Null Hypothesis ($H_{o}$): Proximity to campus (campusDistance) does not affect participation in extracurricular activities.
-   Alternative Hypothesis ($H_{1}$): Proximity to campus (campusDistance) has an effect on participation in extracurricular activities.

### Campus Distance and Activity Count

Statistical Test: To evaluate this, we used the correlation analysis test between campus distance and the number of extracurricular activities using Pearson’s correlation test. Prior to conducting this test, we will verify the assumptions for the test first.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Correlation Analysis"
#| label: table1


# Create summaries for campusDistance and activityCount
campus <- summary(data$campusDistance)
activity <- summary(data$activityCount)

# Combine the summaries into a data frame
summary_t <- data.frame(
  Statistic = c("Min", "1st Quartile", "Median", "Mean", "3rd Quartile", "Max"),
  CampusDistance = as.numeric(campus),
  ActivityCount = as.numeric(activity)
)

library(knitr)

kable(summary_t, format = "pipe", col.names = c("Statistic", "CampusDistance", "ActivityCount"))
```

The descriptive statistics suggest that most students live fairly close to campus (within 2-3 units) and participate in 1-2 extracurricular activities. This variability in both campusDistance and activityCount supports further analysis to see if there’s a relationship between proximity and participation.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig-cap: "Scatter Plot"
#| label: fig-plot1
# Load necessary libraries
library(ggplot2)

# Scatter plot with smoothing line to assess linearity
ggplot(data, aes(x = campusDistance, y = activityCount)) +
  geom_point(color ="darkgreen") +
  geom_smooth(method = "lm", col = "orange", se = FALSE) +
  labs(title = "Campus Distance vs. Activity Count with Linear Trend Line",
       x = "Campus Distance",
       y = "Activity Count")

```

Moving on we inspect the relationship between the variables. As it can be seen from @fig-plot1, there seems to be no linear relation between the variables.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig-cap: "Scatter Plot"
#| label: plot2
# Fit preliminary model
model <- lm(activityCount ~ campusDistance, data = data)

# Q-Q plot for normality of residuals
qqnorm(residuals(model))
qqline(residuals(model), col = "red")

```

The Q-Q plot displays how the residuals (differences between observed and fitted values) align with the normal distribution. In this case, residuals do not fully align along the red diagonal line, indicating that normality is somewhat violated. The observed points deviate in a stepwise manner, particularly at the tails, which suggests potential non-normality in residuals.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Scatter Plot"
#| label: plot3


# Residuals vs Fitted plot to assess homoscedasticity
plot(model, which = 1)


```

This plot helps in identifying any non-linearity, unequal variance (heteroscedasticity), or outliers. Here, residuals seem randomly scattered around the fitted line with no obvious pattern, suggesting homoscedasticity (constant variance). However, a few points like 33, 9, and 15 appear as potential outliers, which might influence the results.

Since there is non-normality between these variables, we proceed with Spearman's rank correlation to analyze the association between campus distance and activity count.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Correlation Test Results"
#| label: tbl-plot4

# Create a data frame to summarize the correlation test results
correlation_results <- data.frame(
  Test = c("Pearson's Correlation", "Spearman's Correlation"),
  Correlation_Coefficient = c(-0.018, 0.025),
  p_value = c(0.891, 0.847),
  Significance = c("Not Significant", "Not Significant")
)


kable(correlation_results, caption = "Summary of Correlation Test Results")

```

The Spearman's rank correlation test results are as follows:

-   Spearman correlation coefficient: 0.025
-   p-value: 0.847

This result indicates a very weak positive correlation between `campusDistance` and `activityCount`, but it is not statistically significant (p-value \> 0.05). Therefore, we fail to reject the null hypothesis, suggesting no significant association between proximity to campus and participation in extracurricular activities based on this data.

## Research Question 3

In RQ3, we analyzed if the the timing, the time spent on extra curricular activity affected one’s level of participation in extracurricular activities.

-   Null Hypothesis ($H_{o}$): Time Commitment (timeCommitment) does not affect participation levels in extracurricular activities.
-   Alternative Hypothesis ($H_{1}$): Time Commitment (timeCommitment) has an effect on participation levels in extracurricular activities.

We used the variables of student involvement (studentInvolvement) and activity count (activityCount) to represent the participation levels.

### Time Commitment and Student Involvement

**Statistical Test**: To evaluate this, we used the correlation analysis test between time commitment and student involvement variables using Spearman’s correlation test. Before proceeding with the test, we will verify the assumptions for the test.

**Normality of Variables**: In our exploration we found that the variables of timeCommitment (TC), and studentInvolvement (SI) are not normally distributed as seen by the QQ plots in @fig-normality-of-variables as they deviate from the normality line. Hence we proceeded to apply the correlation test using the Spearman's rank coefficient instead of Pearson's coefficient (requiring normality).

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig-cap: "Normality of Variables"
#| label: fig-normality-of-variables 
library(rstanarm)

# Set up the plotting area for two plots side by side
par(mfrow = c(1, 2)) 

# QQ plot for timeCommitment
qqnorm(data$timeCommitment, main = "QQ Plot (TC)", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(data$timeCommitment, col = "red")

# QQ plot for studentInvolvement
qqnorm(data$studentInvolvement, main = "QQ Plot (SI)", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(data$studentInvolvement, col = "blue")

# Reset the plotting layout to default (if needed for subsequent plots)
par(mfrow = c(1, 1))

```

**Monotonic Association**: Next we confirmed the assumption of Spearman's rank coefficient test requiring a monotonic relationship between the variables (timeCommitment and studentInvovlement). We found that the relationship between these variables was monotonic, specifically increasing as seen in @fig-scatter-plot-involvement.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig-cap: "Checking Monotonicity"
#| label: fig-scatter-plot-involvement
# Load necessary libraries
library(ggplot2)

# Create a scatter plot
ggplot(data, aes(x = timeCommitment, y = studentInvolvement)) +
  geom_point(color = "darkgreen") +                             # Set points to green
  geom_smooth(method = "lm", color = "orange", se = FALSE) + # Set line to orange
  ggtitle("Time Commitment and Student Involvement") +
  xlab("Time per week (hrs)") +
  ylab("Involvement (1-10)")


```

**Results**: As seen in @tbl-spear-corr, the Spearman's rank correlation coefficient is 0.808, which indicates a strong positive correlation, pointing to a significant monotonic relationship between timeCommitment and studentInvolvement. p-value is \< 0.05, hence the correlation is statistically significant, and we can reject the null-hypothesis.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Correlation Test Results"
#| label: tbl-spear-corr

# Load the necessary packages
library(knitr)

# Ensure data is defined and contains the necessary columns
# Example: data <- data.frame(timeCommitment = ..., studentInvolvement = ...)

# Perform Spearman's correlation test
result <- cor.test(data$timeCommitment, data$studentInvolvement, method = "spearman", exact = FALSE)

# Extract relevant values
p_value <- sprintf("%.3e", result$p.value)  # Format p-value in scientific notation
rho <- sprintf("%.3f", result$estimate)     # Format rho to 3 decimal places

# Create a data frame for the table
table_results <- data.frame(
  Statistic = c("Spearman Coefficient (rho)", "p-value"),
  Value = c(rho, p_value)
)

# Display the table with basic kable (without additional styling)
kable(table_results, caption = "Spearman's Rank Correlation Results")

```

Hence students who spend more time in the activities have higher participation in extra curricular activities measured by the activity count, as suggested by the strong association based on our data.

### Time Commitment and Activity Count

We wanted to check whether the time commitment and participation measured by the activityCount variable were correlated.

**Statistical Test**:

As discussed before, both the timeCommitment and activityCount variables did not meet normality assumptions, so we proceed with the Spearman's rank correlation coefficient as our statistical test.

**Normality of Variables**:

To proceed with this test, we used QQ-plots to verify normality of timeCommitment (TC) and activityCount(AC). As seen in @fig-normality-activity they are non-normal variables due to their deviation from the normal line.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig-cap: "Normality of Variables"
#| label: fig-normality-activity
library(rstanarm)

# Set up the plotting area for two plots side by side
par(mfrow = c(1, 2)) 

# QQ plot for timeCommitment 
qqnorm(data$timeCommitment, main = "QQ Plot (TC)", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(data$timeCommitment, col = "red")

# QQ plot for activity count 
qqnorm(data$activityCount, main = "QQ Plot (AC)", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(data$studentInvolvement, col = "blue")

# Reset the plotting layout to default (if needed for subsequent plots)
par(mfrow = c(1, 1))

```

**Monotonic Association**: We confirmed that the relationship between these variables was monotonic, specifically increasing as seen in @fig-monotonic-activity

```{r}
#| label: fig-monotonic-activity
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig-cap: "Checking Monotonicity"

# Load necessary libraries
library(ggplot2)

# Create a scatter plot
ggplot(data, aes(x = timeCommitment, y = activityCount)) +
  geom_point(color = "darkgreen") +                             # Set points to green
  geom_smooth(method = "lm", color = "orange", se = FALSE) + # Set line to orange
  ggtitle("Time Commitment and Activity Count") +
  xlab("Time per week (hrs)") +
  ylab("Number of Activities")


```

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Correlation Test Results"
#| label: spear_corr_2

# Load the necessary packages
library(knitr)

# Ensure data is defined and contains the necessary columns
# Example: data <- data.frame(timeCommitment = ..., studentInvolvement = ...)

# Perform Spearman's correlation test
result <- cor.test(data$timeCommitment, data$activityCount, method = "spearman", exact = FALSE)

# Extract relevant values
p_value <- sprintf("%.3e", result$p.value)  # Format p-value in scientific notation
rho <- sprintf("%.3f", result$estimate)     # Format rho to 3 decimal places

# Create a data frame for the table
table_results <- data.frame(
  Statistic = c("Spearman Coefficient (rho)", "p-value"),
  Value = c(rho, p_value)
)

# Display the table with basic kable (without additional styling)
kable(table_results, caption = "Spearman's Rank Correlation Results")

```

**Results**: The test results show that the coefficient value is 0.937, indicating a strong positive relationship. This would mean as time commitment increases, so does activity count. The p-value is \< 0.05 and indicates strong evidence against the null hypothesis, hence the relationship is unlikely due to chance.

Hence, these results indicate a strong, statistically significant monotonic relationship between time commitment and activity count. As students increase their time commitment, so does their participation measured by involvement.

# Limitations {#sec-data3}

This study aimed to understand the reasons why students select and participate in ECAs at UTM. Although our results did not yield significant findings, several limitations may have contributed to this outcome:

One such notable limitation is the way in which our data was collected. Although we proposed StRS to collect our data, the study was carried out with SRS. StRS was not used due to the poor choice of strata, ones that were essentially homogeneous. In future studies, a better sampling methodology would have been to use StRS with a better choice of strata along with SRS or Systematic Sampling within the strata. A proposal for better choice of strata would be to use student status as that is much less likely to be homogeneous, rather than lecture section which is generally chosen by convenience to the student, rather than real differences within the population.

If the study were to be repeated, there would be a number of changes we would like to make in addition to modifying the sampling methodology. We would change the student major question from multiselect to a select one and instruct students to select the major they commit the most time to; this would allow us to streamline and simplify the analysis. The question regarding days of the week could likely be dropped as it proved to be nonbeneficial. This question could be instead replaced with one regarding what time of day students spend most in ECAs. Finally, we would likely change the question regarding students living distance from campus to commute time. Since the study is interested in what factors affect ECA participation, considering commute distance would be more likely to provide useful information, as two students living the same distance from campus could have vastly different commute times and thus have different amounts of time they can spend on ECAs.

# Conclusion

This study aimed to investigate the reasons that students select certain extracurricular activities at the University of Toronto Mississauga campus (UTM). Analysis on the preferred types of extracurricular activities whilst also examining whether demographic factors influence these preferences showed that although the most popular type of ECAs among students was Athletics and Sports, demographic factors such as gender, student status and program of study have no significant effect on the preference for certain ECAs. Regarding the proximity to campus and one's ability to participate in ECAs, there indicated a very weak positive relationship between the distance from campus and the number of activities that students engage in. Unfortunately, this relationship is not statistically significant. Finally, analysis on the time spent on ECAs indicates that there is a strong statistically significant relationship between time commitment and activity count. Notably, in the future, it would be more beneficial to consider time commuting as a variable of interest than distance from campus. Additionally, modifying the sampling methodology would be an important change if this study were to be repeated by other researchers. Choosing a sampling methodology such as StRS with strata that are have true differences between them would allow for the benefits that come from StRS including a reduced variance, which would strengthen the results.
\newpage
